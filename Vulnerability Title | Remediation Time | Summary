WITH
    vulnerability AS(
        SELECT title, vulnerability_id, CAST(cvss_score AS NUMERIC)
            FROM dim_vulnerability
                WHERE cvss_score >= 4
    ),
    solution AS(
        SELECT summary, solution_id
            FROM dim_solution
    ),
    vulnerability_solution AS(
        SELECT vulnerability_id, solution_id, title, summary
            FROM dim_vulnerability_solution
                JOIN vulnerability USING (vulnerability_id)
                JOIN solution USING (solution_id)
    ),
    asset_information AS(
        SELECT asset_id, host_name, ip_address
            FROM dim_asset where ip_address='IP ADDRESS'
    ),
    asset_vulnerability_solution AS(
        SELECT vulnerability_id, solution_id, asset_id, host_name, ip_address, title, summary
            FROM fact_asset_vulnerability_age
                JOIN vulnerability_solution USING (vulnerability_id)
                JOIN asset_information USING (asset_id)
    )
SELECT DISTINCT ON (title) title AS "Title",  summary AS "Summary"
    FROM asset_vulnerability_solution
